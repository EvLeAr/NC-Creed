<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Save Our Creed!</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html {
    background: url("creation.jpg") no-repeat center center fixed;
    background-size: cover;
}

body {
    font-family: Arial, sans-serif;
    max-width: 1200px;
    margin: 20px auto;
    padding: 16px;
    background-color: rgba(245, 250, 255, 0.95);
}

h1 { text-align:center; margin:6px 0; }

#story {
    text-align:center;
    font-weight:bold;
    line-height:1.7;
    margin:20px 0;
    font-size:1.25rem;
}

#status {
    text-align:center;
    font-weight:bold;
    margin-bottom:15px;
}

#audioBox {
    border:3px dashed #9bb7d9;
    background:#f4f9ff;
    border-radius:12px;
    padding:14px;
    margin-bottom:20px;
    text-align:center;
}

#audioBox.unlocked {
    border-color:#2e7d32;
    background:#eaf8ee;
}

.row {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:14px;
    margin-bottom:10px;
}

.english {
    background:#e8f0ff;
    border:2px solid #b6ccff;
    padding:12px;
    border-radius:10px;
    font-weight:bold;
}

.latin {
    background:#fff3ff;
    border:3px solid #caa0d8;
    padding:12px;
    border-radius:10px;
    font-weight:bold;
    cursor:grab;
    touch-action:none;
}

.latin.correct {
    background:#e9f8ef;
    border-color:#2e7d32;
}

.latin-text {
    margin-bottom:8px;
}

.controls {
    text-align:center;
}

.controls button {
    width:44px;
    height:44px;
    font-size:1.2rem;
    font-weight:bold;
    margin:0 4px;
}

/* ===== COMPLETION OVERLAY ===== */

#completionOverlay {
    display:none;
    position:fixed;
    inset:0;
    background:rgba(200,235,210,0.96);
    z-index:9999;
}

#completionContent {
    position:relative;
    top:40%;
    transform:translateY(-40%);
    text-align:center;
}

#completionContent h2 {
    font-size:5rem;          /* BIGGER */
    color:#1f7a3a;           /* GREEN */
    margin-bottom:24px;
}

.firework {
    position:absolute;
    width:8px;
    height:8px;
    background:#1f7a3a;
    border-radius:50%;
    animation:explode 1.5s ease-out forwards;
}

@keyframes explode {
    from { transform:scale(0); opacity:1; }
    to   { transform:scale(6); opacity:0; }
}

#restartBox {
    text-align:center;
    margin-top:20px;
}

#restartBox button {
    font-size:1.1rem;
    font-weight:bold;
    padding:10px 20px;
}

@media (max-width:700px) {
    .row { grid-template-columns:1fr; }
}
</style>
</head>

<body>

<div id="mobileBlocker" style="
    display:none;
    position:fixed;
    inset:0;
    background:#f2f6ff;
    z-index:10000;
    text-align:center;
    padding-top:20vh;
">
    <h1 style="font-size:3rem;">Save Our Creed!</h1>
    <p style="font-size:1.6rem; max-width:600px; margin:30px auto;">
        This activity cannot be run on phones.<br><br>
        Please open it on a laptop or desktop computer.
    </p>
</div>

<h1 style="font-size:3rem;">Save Our Creed!</h1>
<h1>RELI/EURO 270: Religion in Western Europe</h1>
<h1>Dr. Evyatar Marienberg &amp; ChatGPT, 2026</h1>

<div id="story">
Heretics attacked us! We need your help!<br>
Put the following 29 lines of the Latin version<br>
of the Nicene-Constantinopolitan Creed<br>
back in order!
</div>

<div id="status">
    <div id="timer">Time: 00:00</div>
    <div id="counter">0 lines out of 29 are correct</div>
</div>

<div id="audioBox">
    This audio of the chanting of the Latin version can help,
    but it will open only after you place 12 lines in the correct place.
    <div id="audioStatus">üîí Audio locked</div>
    <div id="audioControls" style="display:none;">
        <button onclick="audioBack()">‚è™</button>
        <button onclick="audioPlay()">‚ñ∂</button>
        <button onclick="audioPause()">‚è∏</button>
        <button onclick="audioForward()">‚è©</button>
    </div>
</div>

<div id="grid"></div>

<div id="restartBox">
    <button onclick="restartGame()">Restart</button>
</div>

<div id="completionOverlay">
    <div id="completionContent">
        <h2>Fixed! Halleluja! Glory to the Father, and to the Son, and to the Holy Spirit! And to you too!!!</h2>
        <p id="finalTime"></p>
    </div>
</div>

<audio id="audioPlayer" src="NCCreed.mp4"></audio>

<script>
(function blockPhones(){
    const isPhone = /iPhone|Android.+Mobile|Windows Phone/i.test(navigator.userAgent);
    if (isPhone) {
        document.getElementById("mobileBlocker").style.display = "block";
        document.body.style.overflow = "hidden";
        throw new Error("Blocked on phone");
    }
})();

const ENGLISH = [
"01. I believe in one God,","02. the Father almighty,",
"03. maker of heaven and earth,","04. of all things visible and invisible.",
"05. And in one Lord Jesus Christ,","06. the Only Begotten Son of God,",
"07. born of the Father before all ages.","08. God from God, Light from Light,",
"09. true God from true God,","10. begotten, not made, consubstantial with the Father;",
"11. through him all things were made.",
"12. For us men and for our salvation he came down from heaven,",
"13. and by the Holy Spirit was incarnate","14. of the Virgin Mary, and became man.",
"15. For our sake he was crucified under Pontius Pilate,",
"16. he suffered death and was buried,",
"17. and rose again on the third day, in accordance with the Scriptures.",
"18. He ascended into heaven, and is seated at the right hand of the Father.",
"19. He will come again in glory","20. to judge the living and the dead",
"21. and his kingdom will have no end.",
"22. And in the Holy Spirit, the Lord, the giver of life,",
"23. who proceeds from the Father and the Son,",
"24. who with the Father and the Son is adored and glorified,",
"25. who has spoken through the prophets.",
"26. And one, holy, catholic and apostolic Church.",
"27. I confess one baptism for the forgiveness of sins",
"28. and I look forward to the resurrection of the dead",
"29. and the life of the world to come. Amen."
];

const LATIN_CORRECT = [
"(1) Credo in unum Deum,","Patrem omnipotentem,",
"(3) factorem caeli et terrae,","visibilium omnium et invisibilium,",
"Et in unum Dominum Iesum Christum,","Filium Dei unigenitum,",
"et ex Patre natum, ante omnia saecula,",
"(8) Deum de Deo, lumen de Lumine,","Deum verum de Deo vero,",
"genitum, non factum, consubstantialem Patri:",
"(11) per quem omnia facta sunt.",
"Qui propter nos homines et propter nostram salutem descendit de caelis.",
"Et incarnatus est de Spiritu Sancto",
"ex Maria Virgine, et homo factus est.",
"Crucifixus etiam pro nobis sub Pontio Pilato;",
"passus et sepultus est,",
"(17) et resurrexit tertia die, secundum Scripturas,",
"et ascendit in caelum, sedet ad dexteram Patris.",
"Et iterum venturus est cum gloria,",
"iudicare vivos et mortuos,",
"cuius regni non erit finis.",
"(22) Et in Spiritum Sanctum, Dominum et vivificantem:",
"qui ex Patre Filioque procedit.",
"Qui cum Patre et Filio simul adoratur et conglorificatur:",
"qui locutus est per prophetas.",
"(26) Et unam, sanctam, catholicam et apostolicam Ecclesiam.",
"Confiteor unum baptisma in remissionem peccatorum.",
"Et exspecto resurrectionem mortuorum,",
"(29) et vitam venturi saeculi. Amen."
];

let latin = LATIN_CORRECT.map((t,i)=>({text:t, correct:i}));
const fixed = latin.filter(l => /^\(\d+\)/.test(l.text));
const movable = latin.filter(l => !/^\(\d+\)/.test(l.text)).sort(()=>Math.random()-0.5);
latin = LATIN_CORRECT.map(t => /^\(\d+\)/.test(t) ? fixed.shift() : movable.shift());

let timerStarted=false, startTime=null, completed=false, audioUnlocked=false, dragIndex=null;

function startTimer(){
    if(timerStarted) return;
    timerStarted=true;
    startTime=Date.now();
    setInterval(()=>{
        const s=Math.floor((Date.now()-startTime)/1000);
        timer.textContent=`Time: ${String(Math.floor(s/60)).padStart(2,"0")}:${String(s%60).padStart(2,"0")}`;
    },1000);
}

function render(){
    grid.innerHTML="";
    latin.forEach((l,i)=>{
        const row=document.createElement("div");
        row.className="row";

        const e=document.createElement("div");
        e.className="english";
        e.textContent=ENGLISH[i];

        const d=document.createElement("div");
        d.className="latin"+(l.correct===i?" correct":"");
        d.draggable=!completed;

        const text=document.createElement("div");
        text.className="latin-text";
        text.textContent=l.text;
        d.appendChild(text);

        d.addEventListener("dragstart",()=>{ if(!completed){ dragIndex=i; startTimer(); }});
        d.addEventListener("dragover",e=>e.preventDefault());
        d.addEventListener("drop",()=>{
            if(dragIndex===null||completed) return;
            const item=latin.splice(dragIndex,1)[0];
            latin.splice(i,0,item);
            dragIndex=null;
            render(); check();
        });

        const up=document.createElement("button");
        up.textContent="‚Üë";
        up.onclick=()=>move(i,i-1);

        const down=document.createElement("button");
        down.textContent="‚Üì";
        down.onclick=()=>move(i,i+1);

        up.disabled=down.disabled=completed;

        const c=document.createElement("div");
        c.className="controls";
        c.append(up,down);

        d.appendChild(c);

        row.append(e,d);
        grid.append(row);
    });
}

function move(from,to){
    if(completed) return;
    startTimer();
    if(to<0||to>=latin.length) return;
    [latin[from],latin[to]]=[latin[to],latin[from]];
    render(); check();
}

function check(){
    const ok=latin.filter((l,i)=>l.correct===i).length;
    counter.textContent=`${ok} lines out of 29 are correct`;

    if(ok>=12&&!audioUnlocked){
        audioUnlocked=true;
        audioControls.style.display="block";
        audioStatus.textContent="üîì Audio unlocked";
        audioBox.classList.add("unlocked");
    }

    if(ok===29&&!completed){
        completeGame(false);
    }
}

function completeGame(forced){
    completed=true;
    latin=LATIN_CORRECT.map((t,i)=>({text:t,correct:i}));
    render();
    counter.textContent="29 lines out of 29 are correct";

    if(forced){
        finalTime.textContent="Completed in 0 minutes and 0 seconds";
    } else {
        const s=Math.floor((Date.now()-startTime)/1000);
        finalTime.textContent=`Completed in ${Math.floor(s/60)} minutes and ${s%60} seconds`;
    }

    showCompletion();
}

function showCompletion(){
    completionOverlay.style.display="block";
    for(let i=0;i<30;i++) spawnFirework();
    setTimeout(()=>completionOverlay.style.display="none",3500);
}

function spawnFirework(){
    const f=document.createElement("div");
    f.className="firework";
    f.style.left=Math.random()*100+"%";
    f.style.top=Math.random()*100+"%";
    completionOverlay.appendChild(f);
    setTimeout(()=>f.remove(),1500);
}

function audioPlay(){ audioPlayer.play(); }
function audioPause(){ audioPlayer.pause(); }
function audioBack(){ audioPlayer.currentTime=Math.max(0,audioPlayer.currentTime-10); }
function audioForward(){ audioPlayer.currentTime+=10; }

function restartGame(){ location.reload(); }

document.addEventListener("keydown",e=>{
    if(!e.shiftKey) return;
    if(e.key==="A"){
        audioUnlocked=true;
        audioControls.style.display="block";
        audioStatus.textContent="üîì Audio unlocked (instructor)";
        audioBox.classList.add("unlocked");
    }
    if(e.key==="D"){
        completeGame(true);
    }
    if(e.key==="R"){
        restartGame();
    }
});

render(); check();
</script>

</body>
</html>
